"""Genera el archivo Impo_categorias.sql a partir de la lista proporcionada."""

from pathlib import Path
import re
import time
import unicodedata

BASE_DIR = Path(__file__).resolve().parent
OUTPUT_FILE = BASE_DIR / "Impo_categorias.sql"

CATEGORY_NAMES = [
    "ABOGACÍA",
    "ABOGACÍA Y NOTARIADO",
    "ABOGADA",
    "ABOGADA Y NOTARIA",
    "ABOGADO",
    "ABORDAJE PSICOLÓGICO INDIVIDUAL / PSICO LABORAL. CHARLAS Y TALLERES",
    "AGENCIA DE VIAJES",
    "AGRICULTURA",
    "AIRE ACONDIOCIONADO",
    "ALQUILER DE MOBILIARIO PARA FIESTAS Y EVENTOS CORPORATIVOS",
    "ALQUILER MAQUINAS DE HIELO",
    "ALQUILERES",
    "ALQUILERES ( VEHICULO)",
    "ALQUILERES COMERCIALES",
    "ALQUILERES Y AGRICULTURA",
    "ANIMACION Y EVENTOS",
    "APICULTURA",
    "ARQUITECTURA",
    "ARQUITECTURA Y CONSTRUCCION",
    "ARQUITECTURA Y CONSTRUCCIÓN",
    "ARQUITECTURA, CONSULTORÍA Y CONSTRUCCIÓN",
    "ASEGURADORA",
    "ASERRADERO",
    "ASESOR COMISIONISTA",
    "ASESOR EN NEUROMARKETING",
    "ASESOR INMOBILIARIO",
    "ASESOR PUBLICITARIO",
    "ASESORAMIENTO EMPRESARIAL",
    "ASESORES POLÍTICOS",
    "ASESORIA AGRICOLA Y FUMIGACIÓN AEREA",
    "ASESORIA EMPRESARIAL",
    "ASESORIAS",
    "ASESORIAS MEDICAS",
    "ASESORÍA EMPRENDIMIENTOS, PSICOLOGIA",
    "ASESORÍA EN LICITACIONES PÚBLICAS",
    "ASESORÍA EN MARKETING",
    "ASESORÍA EN SALUD OCUPACIONAL",
    "ASESORÍAS MÉDICAS",
    "ASOCIACION PEDIATRICA",
    "AUDIOVISUALES",
    "BAR Y REST",
    "BARBERIA",
    "BAZAR",
    "BIENES RAICES",
    "CABINAS",
    "CAFICULTOR",
    "CALL CENTER",
    "CAMARA COMERCIAL DE NUTRICIONISTAS DE CR",
    "CAMPOSANTO Y SERVICIOS FUNERARIOS",
    "CANCHA SINTETICA DE ALQUILER",
    "CAPACITACIONES EMPRESARIALES",
    "CATERING SERVICE",
    "CENTRO INFANTIL",
    "CLINICA FISIOTERAPIA",
    "CLINICA MEDICA",
    "CLÍNICAS DE ESPECIALIDADES MÉDICAS",
    "COACH DEPORTIVO",
    "COFFEE TOURS MARIPOSARIO",
    "COMERCIO",
    "COMERCIO AL POR MENOR",
    "COMIDAS RAPIDAS",
    "CONFERENCISTA MOTIVACIONAL",
    "CONSTRUCTOR",
    "CONSTRUCTOR INDEPENDIENTE",
    "CONSTRUCTORA",
    "CONSULTOR EMPRESARIAL",
    "CONSULTORIA EN AROMATERAPIA",
    "CONSULTORÍA EMPRESARIAL",
    "CONSULTORÍA EN ARQUITECTURA Y CONSTRUCCIÓN",
    "CONTABILIDAD PÚBLICA Y PRIVADA",
    "CONTADURÍA PRIVADA",
    "CONVENIO PARQUEO",
    "COOPERATIVA",
    "CORREDORA DE SEGUROS",
    "CULTIVOS HIDROPÓNICOS",
    "CURSOS ROBOTICA, EXCEL, INGLÉS Y ALUSIVOS",
    "CÁMARA DE PYMES",
    "DENTISTA",
    "DISEÑADORES WEB Y GRAFICOS",
    "DISEÑO GRAFICO",
    "DISTRIBUIDORA DE PAN",
    "DISTRIBUIDORA DE ENVASES PLASTICOS",
    "DISTRIBUIDORA INDEPENDIENTE OMNILIFE",
    "DISTRIBUIDORA LLANTAZ",
    "Desarrollo de proyectos inmobiliarios, venta de propiedades",
    "EDUCACION PRIVADA",
    "EDUCACIÓN UNIVERSITARIA",
    "ELABORACION DE SALSAS PICANTES",
    "ELABORACIÓN DE PRODUCTOS DE LIMPIEZA AMIGABLES CON LA NATURALEZA",
    "ELECTRICISTA",
    "EMPRENDEDOR",
    "EMPRESA CAFICULTORA",
    "EMPRESA DE RECICLAJE",
    "ENFERMERÍA",
    "ENFOQUE EN LA PREVENCIÓN DEL SUICIDIO",
    "ENSEÑANZA DEL INGLÉS",
    "ESCUELA DE ENSEÑANSA ESPECIAL",
    "ESCUELAS PARA JÓVENES ES SITUACIÓN DE VULNERABILIDAD",
    "ESTETICA",
    "FABRICA DE MUEBLES",
    "FABRICA DE PRODUCTOS DE HIERRO",
    "FABRICACION DE MUEBLES DE CAMA",
    "FABRICACION DE VINOS",
    "FACTURA ELECTRONICA, COWORKING, ALQUILER DE OFICINAS, OUTSOURCING, AGENCIA DIGITAL, SOLUCIONES WEB, LEGAL TRIBUTARIO",
    "FACTURACIÓN ELECTRÓNICA Y CONTABILIDAD REGIMEN SIMPLIFICADO",
    "FARMACIA",
    "FERRETERIA",
    "FINANCIERA",
    "FISIOTERAPIA",
    "FOMENTO DE LA APICULTURA",
    "FOTOGRAFIA",
    "FOTOGRAFÍA",
    "FRUTAS Y ABARROTES",
    "FUNERARIA Y SALAS DE VELACION",
    "GANADERÍA",
    "GIMNASIO",
    "GRUPO MUSICAL CLÁSICOS ROQUEROS",
    "HELADERIA",
    "HOTEL DE PLAYA",
    "HOTEL EN FORTUNA",
    "IMPORTACION Y VENTA DE VEHICULOS",
    "IMPORTADORA, VENTA DE ARTICULOS PARA EL HOGAR Y FERRETERIA",
    "IMPRESIONES Y ROTULACION",
    "INFLABLES Y ALQUILER DE MOBILIARIOS",
    "INFORMATICO",
    "INFORMÁTICA, SOFTWARE",
    "INGENIERO",
    "INGENIERO ELECTRICO",
    "INGENIERÍA CIVIL",
    "INSTALACION DE ROTULOS Y VALLAS PUBLICITARIAS",
    "INSTALACIONES DE AIRE ACONDICIONADO",
    "INSTITUTO EDUCATIVO",
    "INVERSIONES VARIAS",
    "LABORATORIO CLINICO",
    "LABORATORIO MICROBIOLOGIA",
    "LAVACAR",
    "LICORERA",
    "LIMPIEZA PROFESIONAL",
    "LIMPIEZA Y MANTENIMIENTO RESIDENCIAL",
    "MACROBIOTICA",
    "MANICURISTA",
    "MANTENIMIENTO INDUSTRIAL",
    "MANTENIMIENTO INDUSTRIAL, MECÁNICA DE PRESICIÓN, SOLDADURA GENERAL Y SISTEMAS DE BOMBEO Y RIEGO",
    "MARISQUERÍA",
    "MARKETING DIGITAL",
    "MEDICINA ALTERNATIVA",
    "MENSAJERO",
    "MINI SUPER Y LICORERA",
    "MINISUPER",
    "MUEBLERIA",
    "MUEBLES EN METAL, MADERA Y SONDALEZA",
    "NUTRICIONISTA",
    "NUTRICIONISTA / GALLETAS NUTRITIVAS",
    "ODONTOLOGA",
    "ODONTOLOGO",
    "OPTICA",
    "ORGANIZACIÓN FERIAS DE AUTOS",
    "OUTSOURCING DE PERSONAL",
    "PANADERIA",
    "PASTELERÍA Y REPOSTERÍA",
    "PEDIATRÍA",
    "PERFUMERIA",
    "PERIODICO DIGITAL",
    "PESCADERIA Y VENTA DE MARISCOS POR MAYOR Y POR MENOR",
    "PIZZERIA Y RESTAURANTE",
    "PRODUCCION AUDIOS",
    "PRODUCCIÓN DE MIEL",
    "PROFESOR POR CUENTA PROPIA",
    "PSICOLOGIA",
    "PSICOLOGO",
    "PSIOTERAPEUTA",
    "PUBLICIDAD",
    "Producción derivados leche cabra",
    "RENT  A CAR",
    "RESTAURANTE",
    "RESTAURANTE COMIDA MEXICANA",
    "RESTAURANTES",
    "SALAS DE BELLEZA",
    "SALON DE BELLEZA",
    "SEGURIDAD PRIVADA",
    "SEGUROS DE VIDA",
    "SERVICIO DE TRANSPORTE TAXI",
    "SERVICIOS BURSÁTILES",
    "SERVICIOS DE COMPUTACION , IT Y SOFTWARE",
    "SERVICIOS DE ENCOMIENDAS",
    "SERVICIOS DE PSICOLOGÍA",
    "SERVICIOS FINANCIEROS",
    "SERVICIOS FÚNEBRES",
    "SERVICIOS TURISTICOS",
    "SERVICIOS TURÍSTICOS",
    "SERVICIOS TÉCNICOS DE EQUIPO AGRÍCOLA Y JARDINERÍA",
    "SISTEMA Y CONTA TRADICIONAL",
    "SODA",
    "SODA COMIDAS RÁPIDAS",
    "SODA Y RESTAURANTE",
    "SPA Y ESTETICA",
    "SUPERMERCADO",
    "TALLER AUTOMOTRIZ",
    "TALLER DE MOTOS",
    "TALLER DE REPARACION DE COMPUTADORAS",
    "TALLER MECANICO",
    "TATTO CENTER",
    "TAXI",
    "TERAPEUTA",
    "TERAPEUTA FISICO",
    "TIENDA",
    "TIENDA DE LINEA BLANCA Y POR DEPARTAMENTOS",
    "TIENDA DE ROPA",
    "TIENDA ECOLÓGICA EN LA QUE USTED ENCONTRARÁ PRODUCTOS AMIGABLES CON EL AMBIENTE DE BUENAS PRÁCTICAS AGRÍCOLAS",
    "TIENDA ROPA MERICANA",
    "TIENDA VIRTUAL",
    "TRAMO VENTA DE FRUTAS Y VERDURAS",
    "TRANSPORTES",
    "TRANSPORTES ESTRADA",
    "TRANSPORTES PESADO",
    "TRANSPORTES PRIVADOS",
    "TRANSPORTISTA",
    "TRANSPORTISTAS",
    "TÉCNICO EN REFRIGERACIÓN",
    "UNIVERSIDAD",
    "VENTA DE ALIMENTOS PARA MASCOTAS",
    "VENTA DE AUTOS USADOS",
    "VENTA DE AUTOS Y MOTOS, LAVACAR, MECÁNICA RÁPIDA",
    "VENTA DE COMIDA",
    "VENTA DE COSMETICOS Y PERFUMERIA",
    "VENTA DE EQUIPO AGRICOLA",
    "VENTA DE EXTINTORES Y ALUSIVOS",
    "VENTA DE FRUTAS Y VERDURAS",
    "VENTA DE LOTERIA",
    "VENTA DE MATERIALES ELÉCTRICOS",
    "VENTA DE PRODUCTOS ALIMENTICIOS CRIOLLOS",
    "VENTA DE PRODUCTOS FERRETEROS",
    "VENTA DE QUESOS",
    "VENTA DE QUESOS AL POR MAYOR",
    "VENTA DE REPOSTERIA Y PANES",
    "VENTA DE REPUESTOS",
    "VENTA DE ROPA EN LÍNEA",
    "VENTA DE SANDALIAS Y ZAPATOS",
    "VENTA DE SEGUROS DE VIDA",
    "VENTA DE SUMINISTROS Y ACUARIO",
    "VENTA DE TABLILLA PVC Y OTROS MATERIALES AL POR MAYOR",
    "Venta EQUIPO DE CÓMPUTO",
    "VENTA FRAGANCIAS",
    "VENTA FRUTAS Y VERDURAS POR MAYOR Y DETALLE",
    "VENTA Y REPARACIÓN MOTOSIERRAS Y ALUSIVOS",
    "VETERINARIA",
    "VIDEO PRODUCCIÓN Y PUBLICIDAD REDES SOCIALES",
    "VIDEOPRODUCCIÓN",
    "VIDEOS PARA REDES SOCIALES Y DISEÑO WEB",
    "VIDRIERA",
    "VIVERO",
    "ZAPATERIA",
]


def normalize(text: str) -> str:
    text = unicodedata.normalize("NFKD", text)
    text = text.encode("ascii", "ignore").decode("utf-8")
    text = text.lower()
    text = re.sub(r"[^a-z0-9\\s-]", "", text)
    text = re.sub(r"[\\s-]+", "-", text).strip("-")
    return text or "categoria"


def escape_sql(value: str) -> str:
    return value.replace("'", "''")


def build_slug(name: str, counter_map: dict[str, int]) -> str:
    base = normalize(name)
    counter = counter_map.get(base, 0) + 1
    counter_map[base] = counter
    return f"{base}-{counter}"


def generate_sql():
    timestamp = int(time.time())
    counter_map: dict[str, int] = {}
    values_sql: list[str] = []

    for raw_name in CATEGORY_NAMES:
        name = raw_name.strip().upper()
        if not name:
            continue
        slug = build_slug(name, counter_map)
        description = f"SECTOR {name}"
        values_sql.append(
            f"('{escape_sql(name)}', '{escape_sql(slug)}', '{escape_sql(description)}', {timestamp}, {timestamp})"
        )

    content = [
        "-- Archivo generado automáticamente a partir del listado de categorías",
        "INSERT INTO category (name, slug, description, created_at, updated_at) VALUES",
        ",\n".join(values_sql) + ";",
    ]

    OUTPUT_FILE.write_text("\n".join(content), encoding="utf-8")
    print(f"Se generó el archivo SQL con {len(values_sql)} categorías en {OUTPUT_FILE}")


if __name__ == "__main__":
    generate_sql()